###############################################################################
#
# IAR ANSI C/C++ Compiler V8.40.2.214/W32 for ARM         10/Jul/2020  15:12:12
# Copyright 1999-2019 IAR Systems AB.
#
#    Cpu mode     =  
#    Endian       =  little
#    Source file  =
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\STM32F4xx_DSP_StdPeriph_Lib_V1.8.0\Libraries\CMSIS\Device\ST\STM32F4xx\Source\Templates\system_stm32f4xx.c
#    Command line =
#        -f C:\Users\Evan\AppData\Local\Temp\EWFBC1.tmp
#        (E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\STM32F4xx_DSP_StdPeriph_Lib_V1.8.0\Libraries\CMSIS\Device\ST\STM32F4xx\Source\Templates\system_stm32f4xx.c
#        -D USE_STDPERIPH_DRIVER -D STM32F429_439xx -lC
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\Debug\List
#        -o
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\Debug\Obj
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M4 -e --fpu=VFPv4_sp --dlib_config "D:\IAR
#        Systems\Embedded Workbench 8.3\arm\inc\c\DLib_Config_Normal.h" -I
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\..\STM32F4xx_DSP_StdPeriph_Lib_V1.8.0\Libraries\CMSIS\Device\ST\STM32F4xx\Include\
#        -I
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\..\STM32F4xx_DSP_StdPeriph_Lib_V1.8.0\Libraries\CMSIS\Device\ST\STM32F4xx\Source\Templates\
#        -I
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\..\STM32F4xx_DSP_StdPeriph_Lib_V1.8.0\Libraries\CMSIS\Device\ST\STM32F4xx\Source\Templates\iar\
#        -I
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\..\STM32F4xx_DSP_StdPeriph_Lib_V1.8.0\Libraries\STM32F4xx_StdPeriph_Driver\inc\
#        -I
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\..\STM32F4xx_DSP_StdPeriph_Lib_V1.8.0\Libraries\STM32F4xx_StdPeriph_Driver\src\
#        -I
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\User\inc\
#        -I
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\User\src\
#        -Ol --use_c++_inline -I "D:\IAR Systems\Embedded Workbench
#        8.3\arm\CMSIS\Core\Include\" -I "D:\IAR Systems\Embedded Workbench
#        8.3\arm\CMSIS\DSP\Include\")
#    Locale       =  C
#    List file    =
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\Debug\List\system_stm32f4xx.lst
#    Object file  =
#        E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\Cubli\Debug\Obj\system_stm32f4xx.o
#
###############################################################################

E:\STM32Project\Cubli_with_STM32F429\Cubli-with-STM32F429\STM32F4xx_DSP_StdPeriph_Lib_V1.8.0\Libraries\CMSIS\Device\ST\STM32F4xx\Source\Templates\system_stm32f4xx.c
      1          /**
      2            ******************************************************************************
      3            * @file    system_stm32f4xx.c
      4            * @author  MCD Application Team
      5            * @version V1.8.0
      6            * @date    09-November-2016
      7            * @brief   CMSIS Cortex-M4 Device Peripheral Access Layer System Source File.
      8            *          This file contains the system clock configuration for STM32F4xx devices.
      9            *             
     10            * 1.  This file provides two functions and one global variable to be called from 
     11            *     user application:
     12            *      - SystemInit(): Setups the system clock (System clock source, PLL Multiplier
     13            *                      and Divider factors, AHB/APBx prescalers and Flash settings),
     14            *                      depending on the configuration made in the clock xls tool. 
     15            *                      This function is called at startup just after reset and 
     16            *                      before branch to main program. This call is made inside
     17            *                      the "startup_stm32f4xx.s" file.
     18            *
     19            *      - SystemCoreClock variable: Contains the core clock (HCLK), it can be used
     20            *                                  by the user application to setup the SysTick 
     21            *                                  timer or configure other parameters.
     22            *                                     
     23            *      - SystemCoreClockUpdate(): Updates the variable SystemCoreClock and must
     24            *                                 be called whenever the core clock is changed
     25            *                                 during program execution.
     26            *
     27            * 2. After each device reset the HSI (16 MHz) is used as system clock source.
     28            *    Then SystemInit() function is called, in "startup_stm32f4xx.s" file, to
     29            *    configure the system clock before to branch to main program.
     30            *
     31            * 3. If the system clock source selected by user fails to startup, the SystemInit()
     32            *    function will do nothing and HSI still used as system clock source. User can 
     33            *    add some code to deal with this issue inside the SetSysClock() function.
     34            *
     35            * 4. The default value of HSE crystal is set to 25MHz, refer to "HSE_VALUE" define
     36            *    in "stm32f4xx.h" file. When HSE is used as system clock source, directly or
     37            *    through PLL, and you are using different crystal you have to adapt the HSE
     38            *    value to your own configuration.
     39            *
     40            * 5. This file configures the system clock as follows:
     41            *=============================================================================
     42            *=============================================================================
     43            *                    Supported STM32F40xxx/41xxx devices
     44            *-----------------------------------------------------------------------------
     45            *        System Clock source                    | PLL (HSE)
     46            *-----------------------------------------------------------------------------
     47            *        SYSCLK(Hz)                             | 168000000
     48            *-----------------------------------------------------------------------------
     49            *        HCLK(Hz)                               | 168000000
     50            *-----------------------------------------------------------------------------
     51            *        AHB Prescaler                          | 1
     52            *-----------------------------------------------------------------------------
     53            *        APB1 Prescaler                         | 4
     54            *-----------------------------------------------------------------------------
     55            *        APB2 Prescaler                         | 2
     56            *-----------------------------------------------------------------------------
     57            *        HSE Frequency(Hz)                      | 25000000
     58            *-----------------------------------------------------------------------------
     59            *        PLL_M                                  | 25
     60            *-----------------------------------------------------------------------------
     61            *        PLL_N                                  | 336
     62            *-----------------------------------------------------------------------------
     63            *        PLL_P                                  | 2
     64            *-----------------------------------------------------------------------------
     65            *        PLL_Q                                  | 7
     66            *-----------------------------------------------------------------------------
     67            *        PLLI2S_N                               | NA
     68            *-----------------------------------------------------------------------------
     69            *        PLLI2S_R                               | NA
     70            *-----------------------------------------------------------------------------
     71            *        I2S input clock                        | NA
     72            *-----------------------------------------------------------------------------
     73            *        VDD(V)                                 | 3.3
     74            *-----------------------------------------------------------------------------
     75            *        Main regulator output voltage          | Scale1 mode
     76            *-----------------------------------------------------------------------------
     77            *        Flash Latency(WS)                      | 5
     78            *-----------------------------------------------------------------------------
     79            *        Prefetch Buffer                        | ON
     80            *-----------------------------------------------------------------------------
     81            *        Instruction cache                      | ON
     82            *-----------------------------------------------------------------------------
     83            *        Data cache                             | ON
     84            *-----------------------------------------------------------------------------
     85            *        Require 48MHz for USB OTG FS,          | Disabled
     86            *        SDIO and RNG clock                     |
     87            *-----------------------------------------------------------------------------
     88            *=============================================================================
     89            *=============================================================================
     90            *                    Supported STM32F42xxx/43xxx devices
     91            *-----------------------------------------------------------------------------
     92            *        System Clock source                    | PLL (HSE)
     93            *-----------------------------------------------------------------------------
     94            *        SYSCLK(Hz)                             | 180000000
     95            *-----------------------------------------------------------------------------
     96            *        HCLK(Hz)                               | 180000000
     97            *-----------------------------------------------------------------------------
     98            *        AHB Prescaler                          | 1
     99            *-----------------------------------------------------------------------------
    100            *        APB1 Prescaler                         | 4
    101            *-----------------------------------------------------------------------------
    102            *        APB2 Prescaler                         | 2
    103            *-----------------------------------------------------------------------------
    104            *        HSE Frequency(Hz)                      | 25000000
    105            *-----------------------------------------------------------------------------
    106            *        PLL_M                                  | 25
    107            *-----------------------------------------------------------------------------
    108            *        PLL_N                                  | 360
    109            *-----------------------------------------------------------------------------
    110            *        PLL_P                                  | 2
    111            *-----------------------------------------------------------------------------
    112            *        PLL_Q                                  | 7
    113            *-----------------------------------------------------------------------------
    114            *        PLLI2S_N                               | NA
    115            *-----------------------------------------------------------------------------
    116            *        PLLI2S_R                               | NA
    117            *-----------------------------------------------------------------------------
    118            *        I2S input clock                        | NA
    119            *-----------------------------------------------------------------------------
    120            *        VDD(V)                                 | 3.3
    121            *-----------------------------------------------------------------------------
    122            *        Main regulator output voltage          | Scale1 mode
    123            *-----------------------------------------------------------------------------
    124            *        Flash Latency(WS)                      | 5
    125            *-----------------------------------------------------------------------------
    126            *        Prefetch Buffer                        | ON
    127            *-----------------------------------------------------------------------------
    128            *        Instruction cache                      | ON
    129            *-----------------------------------------------------------------------------
    130            *        Data cache                             | ON
    131            *-----------------------------------------------------------------------------
    132            *        Require 48MHz for USB OTG FS,          | Disabled
    133            *        SDIO and RNG clock                     |
    134            *-----------------------------------------------------------------------------
    135            *=============================================================================
    136            *=============================================================================
    137            *                         Supported STM32F401xx devices
    138            *-----------------------------------------------------------------------------
    139            *        System Clock source                    | PLL (HSE)
    140            *-----------------------------------------------------------------------------
    141            *        SYSCLK(Hz)                             | 84000000
    142            *-----------------------------------------------------------------------------
    143            *        HCLK(Hz)                               | 84000000
    144            *-----------------------------------------------------------------------------
    145            *        AHB Prescaler                          | 1
    146            *-----------------------------------------------------------------------------
    147            *        APB1 Prescaler                         | 2
    148            *-----------------------------------------------------------------------------
    149            *        APB2 Prescaler                         | 1
    150            *-----------------------------------------------------------------------------
    151            *        HSE Frequency(Hz)                      | 25000000
    152            *-----------------------------------------------------------------------------
    153            *        PLL_M                                  | 25
    154            *-----------------------------------------------------------------------------
    155            *        PLL_N                                  | 336
    156            *-----------------------------------------------------------------------------
    157            *        PLL_P                                  | 4
    158            *-----------------------------------------------------------------------------
    159            *        PLL_Q                                  | 7
    160            *-----------------------------------------------------------------------------
    161            *        PLLI2S_N                               | NA
    162            *-----------------------------------------------------------------------------
    163            *        PLLI2S_R                               | NA
    164            *-----------------------------------------------------------------------------
    165            *        I2S input clock                        | NA
    166            *-----------------------------------------------------------------------------
    167            *        VDD(V)                                 | 3.3
    168            *-----------------------------------------------------------------------------
    169            *        Main regulator output voltage          | Scale1 mode
    170            *-----------------------------------------------------------------------------
    171            *        Flash Latency(WS)                      | 2
    172            *-----------------------------------------------------------------------------
    173            *        Prefetch Buffer                        | ON
    174            *-----------------------------------------------------------------------------
    175            *        Instruction cache                      | ON
    176            *-----------------------------------------------------------------------------
    177            *        Data cache                             | ON
    178            *-----------------------------------------------------------------------------
    179            *        Require 48MHz for USB OTG FS,          | Disabled
    180            *        SDIO and RNG clock                     |
    181            *-----------------------------------------------------------------------------
    182            *=============================================================================
    183            *=============================================================================
    184            *                Supported STM32F411xx/STM32F410xx devices
    185            *-----------------------------------------------------------------------------
    186            *        System Clock source                    | PLL (HSI)
    187            *-----------------------------------------------------------------------------
    188            *        SYSCLK(Hz)                             | 100000000
    189            *-----------------------------------------------------------------------------
    190            *        HCLK(Hz)                               | 100000000
    191            *-----------------------------------------------------------------------------
    192            *        AHB Prescaler                          | 1
    193            *-----------------------------------------------------------------------------
    194            *        APB1 Prescaler                         | 2
    195            *-----------------------------------------------------------------------------
    196            *        APB2 Prescaler                         | 1
    197            *-----------------------------------------------------------------------------
    198            *        HSI Frequency(Hz)                      | 16000000
    199            *-----------------------------------------------------------------------------
    200            *        PLL_M                                  | 16
    201            *-----------------------------------------------------------------------------
    202            *        PLL_N                                  | 400
    203            *-----------------------------------------------------------------------------
    204            *        PLL_P                                  | 4
    205            *-----------------------------------------------------------------------------
    206            *        PLL_Q                                  | 7
    207            *-----------------------------------------------------------------------------
    208            *        PLLI2S_N                               | NA
    209            *-----------------------------------------------------------------------------
    210            *        PLLI2S_R                               | NA
    211            *-----------------------------------------------------------------------------
    212            *        I2S input clock                        | NA
    213            *-----------------------------------------------------------------------------
    214            *        VDD(V)                                 | 3.3
    215            *-----------------------------------------------------------------------------
    216            *        Main regulator output voltage          | Scale1 mode
    217            *-----------------------------------------------------------------------------
    218            *        Flash Latency(WS)                      | 3
    219            *-----------------------------------------------------------------------------
    220            *        Prefetch Buffer                        | ON
    221            *-----------------------------------------------------------------------------
    222            *        Instruction cache                      | ON
    223            *-----------------------------------------------------------------------------
    224            *        Data cache                             | ON
    225            *-----------------------------------------------------------------------------
    226            *        Require 48MHz for USB OTG FS,          | Disabled
    227            *        SDIO and RNG clock                     |
    228            *-----------------------------------------------------------------------------
    229            *=============================================================================
    230            *=============================================================================
    231            *                         Supported STM32F446xx devices
    232            *-----------------------------------------------------------------------------
    233            *        System Clock source                    | PLL (HSE)
    234            *-----------------------------------------------------------------------------
    235            *        SYSCLK(Hz)                             | 180000000
    236            *-----------------------------------------------------------------------------
    237            *        HCLK(Hz)                               | 180000000
    238            *-----------------------------------------------------------------------------
    239            *        AHB Prescaler                          | 1
    240            *-----------------------------------------------------------------------------
    241            *        APB1 Prescaler                         | 4
    242            *-----------------------------------------------------------------------------
    243            *        APB2 Prescaler                         | 2
    244            *-----------------------------------------------------------------------------
    245            *        HSE Frequency(Hz)                      | 8000000
    246            *-----------------------------------------------------------------------------
    247            *        PLL_M                                  | 8
    248            *-----------------------------------------------------------------------------
    249            *        PLL_N                                  | 360
    250            *-----------------------------------------------------------------------------
    251            *        PLL_P                                  | 2
    252            *-----------------------------------------------------------------------------
    253            *        PLL_Q                                  | 7
    254            *-----------------------------------------------------------------------------
    255            *        PLL_R                                  | NA
    256            *-----------------------------------------------------------------------------
    257            *        PLLI2S_M                               | NA
    258            *-----------------------------------------------------------------------------
    259            *        PLLI2S_N                               | NA
    260            *-----------------------------------------------------------------------------
    261            *        PLLI2S_P                               | NA
    262            *-----------------------------------------------------------------------------
    263            *        PLLI2S_Q                               | NA
    264            *-----------------------------------------------------------------------------
    265            *        PLLI2S_R                               | NA
    266            *-----------------------------------------------------------------------------
    267            *        I2S input clock                        | NA
    268            *-----------------------------------------------------------------------------
    269            *        VDD(V)                                 | 3.3
    270            *-----------------------------------------------------------------------------
    271            *        Main regulator output voltage          | Scale1 mode
    272            *-----------------------------------------------------------------------------
    273            *        Flash Latency(WS)                      | 5
    274            *-----------------------------------------------------------------------------
    275            *        Prefetch Buffer                        | ON
    276            *-----------------------------------------------------------------------------
    277            *        Instruction cache                      | ON
    278            *-----------------------------------------------------------------------------
    279            *        Data cache                             | ON
    280            *-----------------------------------------------------------------------------
    281            *        Require 48MHz for USB OTG FS,          | Disabled
    282            *        SDIO and RNG clock                     |
    283            *-----------------------------------------------------------------------------
    284            *=============================================================================
    285            ******************************************************************************
    286            * @attention
    287            *
    288            * <h2><center>&copy; COPYRIGHT 2016 STMicroelectronics</center></h2>
    289            *
    290            * Licensed under MCD-ST Liberty SW License Agreement V2, (the "License");
    291            * You may not use this file except in compliance with the License.
    292            * You may obtain a copy of the License at:
    293            *
    294            *        http://www.st.com/software_license_agreement_liberty_v2
    295            *
    296            * Unless required by applicable law or agreed to in writing, software 
    297            * distributed under the License is distributed on an "AS IS" BASIS, 
    298            * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    299            * See the License for the specific language governing permissions and
    300            * limitations under the License.
    301            *
    302            ******************************************************************************
    303            */
    304          
    305          /** @addtogroup CMSIS
    306            * @{
    307            */
    308          
    309          /** @addtogroup stm32f4xx_system
    310            * @{
    311            */  
    312            
    313          /** @addtogroup STM32F4xx_System_Private_Includes
    314            * @{
    315            */
    316          
    317          #include "stm32f4xx.h"
    318          
    319          /**
    320            * @}
    321            */
    322          
    323          /** @addtogroup STM32F4xx_System_Private_TypesDefinitions
    324            * @{
    325            */
    326          
    327          /**
    328            * @}
    329            */
    330          
    331          /** @addtogroup STM32F4xx_System_Private_Defines
    332            * @{
    333            */
    334          
    335          /************************* Miscellaneous Configuration ************************/
    336          /*!< Uncomment the following line if you need to use external SRAM or SDRAM mounted
    337               on STM324xG_EVAL/STM324x7I_EVAL/STM324x9I_EVAL boards as data memory  */     
    338          #if defined(STM32F40_41xxx) || defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F469_479xx) || defined(STM32F413_423xx)
    339          /* #define DATA_IN_ExtSRAM */
    340          #endif /* STM32F40_41xxx || STM32F427_437x || STM32F429_439xx || STM32F469_479xx || STM32F413_423xx */
    341          
    342          #if defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F446xx) || defined(STM32F469_479xx)
    343          /* #define DATA_IN_ExtSDRAM */
    344          #endif /* STM32F427_437x || STM32F429_439xx || STM32F446xx || STM32F469_479xx */ 
    345          
    346          #if defined(STM32F410xx) || defined(STM32F411xE)
    347          /*!< Uncomment the following line if you need to clock the STM32F410xx/STM32F411xE by HSE Bypass
    348               through STLINK MCO pin of STM32F103 microcontroller. The frequency cannot be changed
    349               and is fixed at 8 MHz. 
    350               Hardware configuration needed for Nucleo Board:
    351               – SB54, SB55 OFF
    352               – R35 removed
    353               – SB16, SB50 ON */
    354          /* #define USE_HSE_BYPASS */
    355          
    356          #if defined(USE_HSE_BYPASS)     
    357          #define HSE_BYPASS_INPUT_FREQUENCY   8000000
    358          #endif /* USE_HSE_BYPASS */    
    359          #endif /* STM32F410xx || STM32F411xE */
    360              
    361          /*!< Uncomment the following line if you need to relocate your vector Table in
    362               Internal SRAM. */
    363          /* #define VECT_TAB_SRAM */
    364          #define VECT_TAB_OFFSET  0x00 /*!< Vector Table base offset field. 
    365                                             This value must be a multiple of 0x200. */
    366          /******************************************************************************/
    367          
    368          /************************* PLL Parameters *************************************/
    369          #if defined(STM32F40_41xxx) || defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F401xx) || defined(STM32F469_479xx)
    370           /* PLL_VCO = (HSE_VALUE or HSI_VALUE / PLL_M) * PLL_N */
    371           #define PLL_M      8 //25
    372          #elif defined(STM32F412xG) || defined(STM32F413_423xx) || defined (STM32F446xx)
    373           #define PLL_M      8
    374          #elif defined (STM32F410xx) || defined (STM32F411xE)
    375           #if defined(USE_HSE_BYPASS)
    376            #define PLL_M      8    
    377           #else /* !USE_HSE_BYPASS */
    378            #define PLL_M      16
    379           #endif /* USE_HSE_BYPASS */
    380          #else
    381          #endif /* STM32F40_41xxx || STM32F427_437xx || STM32F429_439xx || STM32F401xx || STM32F469_479xx */  
    382          
    383          /* USB OTG FS, SDIO and RNG Clock =  PLL_VCO / PLLQ */
    384          #define PLL_Q      7
    385          
    386          #if defined(STM32F446xx)
    387          /* PLL division factor for I2S, SAI, SYSTEM and SPDIF: Clock =  PLL_VCO / PLLR */
    388          #define PLL_R      7
    389          #elif defined(STM32F412xG) || defined(STM32F413_423xx)
    390          #define PLL_R      2
    391          #else
    392          #endif /* STM32F446xx */ 
    393          
    394          #if defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F446xx) || defined(STM32F469_479xx)
    395          #define PLL_N      360
    396          /* SYSCLK = PLL_VCO / PLL_P */
    397          #define PLL_P      2
    398          #endif /* STM32F427_437x || STM32F429_439xx || STM32F446xx || STM32F469_479xx */
    399          
    400          #if defined (STM32F40_41xxx)
    401          #define PLL_N      336
    402          /* SYSCLK = PLL_VCO / PLL_P */
    403          #define PLL_P      2
    404          #endif /* STM32F40_41xxx */
    405          
    406          #if defined(STM32F401xx)
    407          #define PLL_N      336
    408          /* SYSCLK = PLL_VCO / PLL_P */
    409          #define PLL_P      4
    410          #endif /* STM32F401xx */
    411          
    412          #if defined(STM32F410xx) || defined(STM32F411xE) || defined(STM32F412xG) || defined(STM32F413_423xx)
    413          #define PLL_N      400
    414          /* SYSCLK = PLL_VCO / PLL_P */
    415          #define PLL_P      4   
    416          #endif /* STM32F410xx || STM32F411xE || STM32F412xG || STM32F413_423xx */
    417          
    418          /******************************************************************************/
    419          
    420          /**
    421            * @}
    422            */
    423          
    424          /** @addtogroup STM32F4xx_System_Private_Macros
    425            * @{
    426            */
    427          
    428          /**
    429            * @}
    430            */
    431          
    432          /** @addtogroup STM32F4xx_System_Private_Variables
    433            * @{
    434            */
    435          
    436          #if defined(STM32F40_41xxx)
    437            uint32_t SystemCoreClock = 168000000;
    438          #endif /* STM32F40_41xxx */
    439          
    440          #if defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F446xx) || defined(STM32F469_479xx)

   \                                 In section .data, align 4
    441            uint32_t SystemCoreClock = 180000000;
   \                     SystemCoreClock:
   \        0x0   0x0ABA'9500        DC32 180'000'000
    442          #endif /* STM32F427_437x || STM32F429_439xx || STM32F446xx || STM32F469_479xx */
    443          
    444          #if defined(STM32F401xx)
    445            uint32_t SystemCoreClock = 84000000;
    446          #endif /* STM32F401xx */
    447          
    448          #if defined(STM32F410xx) || defined(STM32F411xE) || defined(STM32F412xG) || defined(STM32F413_423xx)
    449            uint32_t SystemCoreClock = 100000000;
    450          #endif /* STM32F410xx || STM32F401xE || STM32F412xG || STM32F413_423xx */
    451          

   \                                 In section .data, align 4
    452          __I uint8_t AHBPrescTable[16] = {0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 6, 7, 8, 9};
   \                     AHBPrescTable:
   \        0x0   0x00 0x00          DC8 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 6, 7, 8, 9
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x01 0x02    
   \              0x03 0x04    
   \              0x06 0x07    
   \              0x08 0x09    
    453          
    454          /**
    455            * @}
    456            */
    457          
    458          /** @addtogroup STM32F4xx_System_Private_FunctionPrototypes
    459            * @{
    460            */
    461          
    462          static void SetSysClock(void);
    463          
    464          #if defined(DATA_IN_ExtSRAM) || defined(DATA_IN_ExtSDRAM)
    465          static void SystemInit_ExtMemCtl(void); 
    466          #endif /* DATA_IN_ExtSRAM || DATA_IN_ExtSDRAM */
    467          
    468          /**
    469            * @}
    470            */
    471          
    472          /** @addtogroup STM32F4xx_System_Private_Functions
    473            * @{
    474            */
    475          
    476          /**
    477            * @brief  Setup the microcontroller system
    478            *         Initialize the Embedded Flash Interface, the PLL and update the 
    479            *         SystemFrequency variable.
    480            * @param  None
    481            * @retval None
    482            */

   \                                 In section .text, align 2, keep-with-next
    483          void SystemInit(void)
    484          {
   \                     SystemInit: (+1)
   \        0x0   0xB580             PUSH     {R7,LR}
    485            /* FPU settings ------------------------------------------------------------*/
    486            #if (__FPU_PRESENT == 1) && (__FPU_USED == 1)
    487              SCB->CPACR |= ((3UL << 10*2)|(3UL << 11*2));  /* set CP10 and CP11 Full Access */
   \        0x2   0x....             LDR.N    R0,??DataTable2  ;; 0xe000ed88
   \        0x4   0x6801             LDR      R1,[R0, #+0]
   \        0x6   0xF451 0x0170      ORRS     R1,R1,#0xF00000
   \        0xA   0x6001             STR      R1,[R0, #+0]
    488            #endif
    489            /* Reset the RCC clock configuration to the default reset state ------------*/
    490            /* Set HSION bit */
    491            RCC->CR |= (uint32_t)0x00000001;
   \        0xC   0x....             LDR.N    R1,??DataTable2_1  ;; 0x40023800
   \        0xE   0x6808             LDR      R0,[R1, #+0]
   \       0x10   0xF050 0x0001      ORRS     R0,R0,#0x1
   \       0x14   0x6008             STR      R0,[R1, #+0]
    492          
    493            /* Reset CFGR register */
    494            RCC->CFGR = 0x00000000;
   \       0x16   0x2000             MOVS     R0,#+0
   \       0x18   0x....             LDR.N    R2,??DataTable2_2  ;; 0x40023808
   \       0x1A   0x6010             STR      R0,[R2, #+0]
    495          
    496            /* Reset HSEON, CSSON and PLLON bits */
    497            RCC->CR &= (uint32_t)0xFEF6FFFF;
   \       0x1C   0x680A             LDR      R2,[R1, #+0]
   \       0x1E   0x....             LDR.N    R0,??DataTable2_3  ;; 0xfef6ffff
   \       0x20   0x4002             ANDS     R2,R0,R2
   \       0x22   0x600A             STR      R2,[R1, #+0]
    498          
    499            /* Reset PLLCFGR register */
    500            RCC->PLLCFGR = 0x24003010;
   \       0x24   0x....             LDR.N    R0,??DataTable2_4  ;; 0x24003010
   \       0x26   0x....             LDR.N    R2,??DataTable2_5  ;; 0x40023804
   \       0x28   0x6010             STR      R0,[R2, #+0]
    501          
    502            /* Reset HSEBYP bit */
    503            RCC->CR &= (uint32_t)0xFFFBFFFF;
   \       0x2A   0x6808             LDR      R0,[R1, #+0]
   \       0x2C   0xF430 0x2080      BICS     R0,R0,#0x40000
   \       0x30   0x6008             STR      R0,[R1, #+0]
    504          
    505            /* Disable all interrupts */
    506            RCC->CIR = 0x00000000;
   \       0x32   0x2000             MOVS     R0,#+0
   \       0x34   0x....             LDR.N    R1,??DataTable2_6  ;; 0x4002380c
   \       0x36   0x6008             STR      R0,[R1, #+0]
    507          
    508          #if defined(DATA_IN_ExtSRAM) || defined(DATA_IN_ExtSDRAM)
    509            SystemInit_ExtMemCtl(); 
    510          #endif /* DATA_IN_ExtSRAM || DATA_IN_ExtSDRAM */
    511                   
    512            /* Configure the System clock source, PLL Multiplier and Divider factors, 
    513               AHB/APBx prescalers and Flash settings ----------------------------------*/
    514            SetSysClock();
   \       0x38   0x....'....        BL       SetSysClock
    515          
    516            /* Configure the Vector Table location add offset address ------------------*/
    517          #ifdef VECT_TAB_SRAM
    518            SCB->VTOR = SRAM_BASE | VECT_TAB_OFFSET; /* Vector Table Relocation in Internal SRAM */
    519          #else
    520            SCB->VTOR = FLASH_BASE | VECT_TAB_OFFSET; /* Vector Table Relocation in Internal FLASH */
   \       0x3C   0xF05F 0x6000      MOVS     R0,#+134217728
   \       0x40   0x....             LDR.N    R1,??DataTable2_7  ;; 0xe000ed08
   \       0x42   0x6008             STR      R0,[R1, #+0]
    521          #endif
    522          }
   \       0x44   0xBD01             POP      {R0,PC}          ;; return
    523          
    524          /**
    525             * @brief  Update SystemCoreClock variable according to Clock Register Values.
    526            *         The SystemCoreClock variable contains the core clock (HCLK), it can
    527            *         be used by the user application to setup the SysTick timer or configure
    528            *         other parameters.
    529            *           
    530            * @note   Each time the core clock (HCLK) changes, this function must be called
    531            *         to update SystemCoreClock variable value. Otherwise, any configuration
    532            *         based on this variable will be incorrect.         
    533            *     
    534            * @note   - The system frequency computed by this function is not the real 
    535            *           frequency in the chip. It is calculated based on the predefined 
    536            *           constant and the selected clock source:
    537            *             
    538            *           - If SYSCLK source is HSI, SystemCoreClock will contain the HSI_VALUE(*)
    539            *                                              
    540            *           - If SYSCLK source is HSE, SystemCoreClock will contain the HSE_VALUE(**)
    541            *                          
    542            *           - If SYSCLK source is PLL, SystemCoreClock will contain the HSE_VALUE(**) 
    543            *             or HSI_VALUE(*) multiplied/divided by the PLL factors.
    544            *         
    545            *         (*) HSI_VALUE is a constant defined in stm32f4xx.h file (default value
    546            *             16 MHz) but the real value may vary depending on the variations
    547            *             in voltage and temperature.   
    548            *    
    549            *         (**) HSE_VALUE is a constant defined in stm32f4xx.h file (default value
    550            *              25 MHz), user has to ensure that HSE_VALUE is same as the real
    551            *              frequency of the crystal used. Otherwise, this function may
    552            *              have wrong result.
    553            *                
    554            *         - The result of this function could be not correct when using fractional
    555            *           value for HSE crystal.
    556            *     
    557            * @param  None
    558            * @retval None
    559            */

   \                                 In section .text, align 2, keep-with-next
    560          void SystemCoreClockUpdate(void)
    561          {
    562            uint32_t tmp = 0, pllvco = 0, pllp = 2, pllsource = 0, pllm = 2;
   \                     SystemCoreClockUpdate: (+1)
   \        0x0   0x2000             MOVS     R0,#+0
   \        0x2   0x2000             MOVS     R0,#+0
   \        0x4   0x2002             MOVS     R0,#+2
   \        0x6   0x2000             MOVS     R0,#+0
   \        0x8   0x2002             MOVS     R0,#+2
    563          #if defined(STM32F412xG) || defined(STM32F413_423xx) || defined(STM32F446xx)  
    564            uint32_t pllr = 2;
    565          #endif /* STM32F412xG || STM32F413_423xx || STM32F446xx */
    566            /* Get SYSCLK source -------------------------------------------------------*/
    567            tmp = RCC->CFGR & RCC_CFGR_SWS;
   \        0xA   0x....             LDR.N    R1,??DataTable2_2  ;; 0x40023808
   \        0xC   0x6808             LDR      R0,[R1, #+0]
   \        0xE   0xF010 0x000C      ANDS     R0,R0,#0xC
    568          
    569            switch (tmp)
   \       0x12   0x2800             CMP      R0,#+0
   \       0x14   0xD004             BEQ.N    ??SystemCoreClockUpdate_0
   \       0x16   0x2804             CMP      R0,#+4
   \       0x18   0xD006             BEQ.N    ??SystemCoreClockUpdate_1
   \       0x1A   0x2808             CMP      R0,#+8
   \       0x1C   0xD008             BEQ.N    ??SystemCoreClockUpdate_2
   \       0x1E   0xE029             B.N      ??SystemCoreClockUpdate_3
    570            {
    571              case 0x00:  /* HSI used as system clock source */
    572                SystemCoreClock = HSI_VALUE;
   \                     ??SystemCoreClockUpdate_0: (+1)
   \       0x20   0x....             LDR.N    R0,??DataTable2_8  ;; 0xf42400
   \       0x22   0x....             LDR.N    R2,??DataTable2_9
   \       0x24   0x6010             STR      R0,[R2, #+0]
    573                break;
   \       0x26   0xE028             B.N      ??SystemCoreClockUpdate_4
    574              case 0x04:  /* HSE used as system clock source */
    575                SystemCoreClock = HSE_VALUE;
   \                     ??SystemCoreClockUpdate_1: (+1)
   \       0x28   0x....             LDR.N    R0,??DataTable2_10  ;; 0x7a1200
   \       0x2A   0x....             LDR.N    R2,??DataTable2_9
   \       0x2C   0x6010             STR      R0,[R2, #+0]
    576                break;
   \       0x2E   0xE024             B.N      ??SystemCoreClockUpdate_4
    577              case 0x08:  /* PLL P used as system clock source */
    578                 /* PLL_VCO = (HSE_VALUE or HSI_VALUE / PLL_M) * PLL_N
    579                   SYSCLK = PLL_VCO / PLL_P
    580                   */    
    581                pllsource = (RCC->PLLCFGR & RCC_PLLCFGR_PLLSRC) >> 22;
   \                     ??SystemCoreClockUpdate_2: (+1)
   \       0x30   0x....             LDR.N    R3,??DataTable2_5  ;; 0x40023804
   \       0x32   0x6818             LDR      R0,[R3, #+0]
   \       0x34   0xF3C0 0x5080      UBFX     R0,R0,#+22,#+1
    582                pllm = RCC->PLLCFGR & RCC_PLLCFGR_PLLM;
   \       0x38   0x681A             LDR      R2,[R3, #+0]
   \       0x3A   0xF012 0x023F      ANDS     R2,R2,#0x3F
    583                
    584          #if defined(STM32F40_41xxx) || defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F401xx) || defined(STM32F412xG) || defined(STM32F413_423xx) || defined(STM32F446xx) || defined(STM32F469_479xx)
    585                if (pllsource != 0)
   \       0x3E   0x2800             CMP      R0,#+0
   \       0x40   0xD007             BEQ.N    ??SystemCoreClockUpdate_5
    586                {
    587                  /* HSE used as PLL clock source */
    588                  pllvco = (HSE_VALUE / pllm) * ((RCC->PLLCFGR & RCC_PLLCFGR_PLLN) >> 6);
   \       0x42   0x....             LDR.N    R0,??DataTable2_10  ;; 0x7a1200
   \       0x44   0xFBB0 0xF2F2      UDIV     R2,R0,R2
   \       0x48   0x6818             LDR      R0,[R3, #+0]
   \       0x4A   0xF3C0 0x1088      UBFX     R0,R0,#+6,#+9
   \       0x4E   0x4342             MULS     R2,R0,R2
   \       0x50   0xE006             B.N      ??SystemCoreClockUpdate_6
    589                }
    590                else
    591                {
    592                  /* HSI used as PLL clock source */
    593                  pllvco = (HSI_VALUE / pllm) * ((RCC->PLLCFGR & RCC_PLLCFGR_PLLN) >> 6);
   \                     ??SystemCoreClockUpdate_5: (+1)
   \       0x52   0x....             LDR.N    R0,??DataTable2_8  ;; 0xf42400
   \       0x54   0xFBB0 0xF2F2      UDIV     R2,R0,R2
   \       0x58   0x6818             LDR      R0,[R3, #+0]
   \       0x5A   0xF3C0 0x1088      UBFX     R0,R0,#+6,#+9
   \       0x5E   0x4342             MULS     R2,R0,R2
    594                }
    595          #elif defined(STM32F410xx) || defined(STM32F411xE)
    596          #if defined(USE_HSE_BYPASS)
    597                if (pllsource != 0)
    598                {
    599                  /* HSE used as PLL clock source */
    600                  pllvco = (HSE_BYPASS_INPUT_FREQUENCY / pllm) * ((RCC->PLLCFGR & RCC_PLLCFGR_PLLN) >> 6);
    601                }  
    602          #else  
    603                if (pllsource == 0)
    604                {
    605                  /* HSI used as PLL clock source */
    606                  pllvco = (HSI_VALUE / pllm) * ((RCC->PLLCFGR & RCC_PLLCFGR_PLLN) >> 6);
    607                }  
    608          #endif /* USE_HSE_BYPASS */  
    609          #endif /* STM32F40_41xxx || STM32F427_437xx || STM32F429_439xx || STM32F401xx || STM32F412xG || STM32F413_423xx ||  STM32F446xx || STM32F469_479xx */  
    610                pllp = (((RCC->PLLCFGR & RCC_PLLCFGR_PLLP) >>16) + 1 ) *2;
   \                     ??SystemCoreClockUpdate_6: (+1)
   \       0x60   0x6818             LDR      R0,[R3, #+0]
   \       0x62   0xF3C0 0x4001      UBFX     R0,R0,#+16,#+2
   \       0x66   0x1C40             ADDS     R0,R0,#+1
   \       0x68   0x0040             LSLS     R0,R0,#+1
    611                SystemCoreClock = pllvco/pllp;      
   \       0x6A   0xFBB2 0xF0F0      UDIV     R0,R2,R0
   \       0x6E   0x....             LDR.N    R2,??DataTable2_9
   \       0x70   0x6010             STR      R0,[R2, #+0]
    612                break;
   \       0x72   0xE002             B.N      ??SystemCoreClockUpdate_4
    613          #if defined(STM32F412xG) || defined(STM32F413_423xx) || defined(STM32F446xx)      
    614                case 0x0C:  /* PLL R used as system clock source */
    615                 /* PLL_VCO = (HSE_VALUE or HSI_VALUE / PLL_M) * PLL_N
    616                   SYSCLK = PLL_VCO / PLL_R
    617                   */    
    618                pllsource = (RCC->PLLCFGR & RCC_PLLCFGR_PLLSRC) >> 22;
    619                pllm = RCC->PLLCFGR & RCC_PLLCFGR_PLLM;
    620                if (pllsource != 0)
    621                {
    622                  /* HSE used as PLL clock source */
    623                  pllvco = (HSE_VALUE / pllm) * ((RCC->PLLCFGR & RCC_PLLCFGR_PLLN) >> 6);
    624                }
    625                else
    626                {
    627                  /* HSI used as PLL clock source */
    628                  pllvco = (HSI_VALUE / pllm) * ((RCC->PLLCFGR & RCC_PLLCFGR_PLLN) >> 6);      
    629                }
    630           
    631                pllr = (((RCC->PLLCFGR & RCC_PLLCFGR_PLLR) >>28) + 1 ) *2;
    632                SystemCoreClock = pllvco/pllr;      
    633                break;
    634          #endif /* STM32F412xG || STM32F413_423xx || STM32F446xx */
    635              default:
    636                SystemCoreClock = HSI_VALUE;
   \                     ??SystemCoreClockUpdate_3: (+1)
   \       0x74   0x....             LDR.N    R0,??DataTable2_8  ;; 0xf42400
   \       0x76   0x....             LDR.N    R2,??DataTable2_9
   \       0x78   0x6010             STR      R0,[R2, #+0]
    637                break;
    638            }
    639            /* Compute HCLK frequency --------------------------------------------------*/
    640            /* Get HCLK prescaler */
    641            tmp = AHBPrescTable[((RCC->CFGR & RCC_CFGR_HPRE) >> 4)];
   \                     ??SystemCoreClockUpdate_4: (+1)
   \       0x7A   0x6808             LDR      R0,[R1, #+0]
   \       0x7C   0x....             LDR.N    R1,??DataTable2_11
   \       0x7E   0xF3C0 0x1003      UBFX     R0,R0,#+4,#+4
   \       0x82   0x5C08             LDRB     R0,[R1, R0]
    642            /* HCLK frequency */
    643            SystemCoreClock >>= tmp;
   \       0x84   0x....             LDR.N    R1,??DataTable2_9
   \       0x86   0x680A             LDR      R2,[R1, #+0]
   \       0x88   0x40C2             LSRS     R2,R2,R0
   \       0x8A   0x600A             STR      R2,[R1, #+0]
    644          }
   \       0x8C   0x4770             BX       LR               ;; return
    645          
    646          /**
    647            * @brief  Configures the System clock source, PLL Multiplier and Divider factors, 
    648            *         AHB/APBx prescalers and Flash settings
    649            * @Note   This function should be called only once the RCC clock configuration  
    650            *         is reset to the default reset state (done in SystemInit() function).   
    651            * @param  None
    652            * @retval None
    653            */

   \                                 In section .text, align 2, keep-with-next
    654          static void SetSysClock(void)
    655          {
   \                     SetSysClock: (+1)
   \        0x0   0xB41C             PUSH     {R2-R4}
    656          #if defined(STM32F40_41xxx) || defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F401xx) || defined(STM32F412xG) || defined(STM32F413_423xx) || defined(STM32F446xx)|| defined(STM32F469_479xx)
    657          /******************************************************************************/
    658          /*            PLL (clocked by HSE) used as System clock source                */
    659          /******************************************************************************/
    660            __IO uint32_t StartUpCounter = 0, HSEStatus = 0;
   \        0x2   0x2000             MOVS     R0,#+0
   \        0x4   0x9001             STR      R0,[SP, #+4]
   \        0x6   0x2000             MOVS     R0,#+0
   \        0x8   0x9000             STR      R0,[SP, #+0]
    661            
    662            /* Enable HSE */
    663            RCC->CR |= ((uint32_t)RCC_CR_HSEON);
   \        0xA   0x....             LDR.N    R1,??DataTable2_1  ;; 0x40023800
   \        0xC   0x6808             LDR      R0,[R1, #+0]
   \        0xE   0xF450 0x3080      ORRS     R0,R0,#0x10000
   \       0x12   0x6008             STR      R0,[R1, #+0]
    664           
    665            /* Wait till HSE is ready and if Time out is reached exit */
    666            do
    667            {
    668              HSEStatus = RCC->CR & RCC_CR_HSERDY;
   \                     ??SetSysClock_0: (+1)
   \       0x14   0x6808             LDR      R0,[R1, #+0]
   \       0x16   0xF410 0x3000      ANDS     R0,R0,#0x20000
   \       0x1A   0x9000             STR      R0,[SP, #+0]
    669              StartUpCounter++;
   \       0x1C   0x9801             LDR      R0,[SP, #+4]
   \       0x1E   0x1C40             ADDS     R0,R0,#+1
   \       0x20   0x9001             STR      R0,[SP, #+4]
    670            } while((HSEStatus == 0) && (StartUpCounter != HSE_STARTUP_TIMEOUT));
   \       0x22   0x9800             LDR      R0,[SP, #+0]
   \       0x24   0x2800             CMP      R0,#+0
   \       0x26   0xD103             BNE.N    ??SetSysClock_1
   \       0x28   0x9801             LDR      R0,[SP, #+4]
   \       0x2A   0xF5B0 0x4FA0      CMP      R0,#+20480
   \       0x2E   0xD1F1             BNE.N    ??SetSysClock_0
    671          
    672            if ((RCC->CR & RCC_CR_HSERDY) != RESET)
   \                     ??SetSysClock_1: (+1)
   \       0x30   0x6808             LDR      R0,[R1, #+0]
   \       0x32   0x0380             LSLS     R0,R0,#+14
   \       0x34   0xD502             BPL.N    ??SetSysClock_2
    673            {
    674              HSEStatus = (uint32_t)0x01;
   \       0x36   0x2001             MOVS     R0,#+1
   \       0x38   0x9000             STR      R0,[SP, #+0]
   \       0x3A   0xE001             B.N      ??SetSysClock_3
    675            }
    676            else
    677            {
    678              HSEStatus = (uint32_t)0x00;
   \                     ??SetSysClock_2: (+1)
   \       0x3C   0x2000             MOVS     R0,#+0
   \       0x3E   0x9000             STR      R0,[SP, #+0]
    679            }
    680          
    681            if (HSEStatus == (uint32_t)0x01)
   \                     ??SetSysClock_3: (+1)
   \       0x40   0x9800             LDR      R0,[SP, #+0]
   \       0x42   0x2801             CMP      R0,#+1
   \       0x44   0xD13E             BNE.N    ??SetSysClock_4
    682            {
    683              /* Select regulator voltage output Scale 1 mode */
    684              RCC->APB1ENR |= RCC_APB1ENR_PWREN;
   \       0x46   0x....             LDR.N    R0,??DataTable2_12  ;; 0x40023840
   \       0x48   0x6802             LDR      R2,[R0, #+0]
   \       0x4A   0xF052 0x5280      ORRS     R2,R2,#0x10000000
   \       0x4E   0x6002             STR      R2,[R0, #+0]
    685              PWR->CR |= PWR_CR_VOS;
   \       0x50   0x....             LDR.N    R0,??DataTable2_13  ;; 0x40007000
   \       0x52   0x6802             LDR      R2,[R0, #+0]
   \       0x54   0xF452 0x4240      ORRS     R2,R2,#0xC000
   \       0x58   0x6002             STR      R2,[R0, #+0]
    686          
    687              /* HCLK = SYSCLK / 1*/
    688              RCC->CFGR |= RCC_CFGR_HPRE_DIV1;
   \       0x5A   0x....             LDR.N    R2,??DataTable2_2  ;; 0x40023808
   \       0x5C   0x6813             LDR      R3,[R2, #+0]
   \       0x5E   0x6013             STR      R3,[R2, #+0]
    689          
    690          #if defined(STM32F40_41xxx) || defined(STM32F427_437xx) || defined(STM32F429_439xx) ||  defined(STM32F412xG) || defined(STM32F446xx) || defined(STM32F469_479xx)    
    691              /* PCLK2 = HCLK / 2*/
    692              RCC->CFGR |= RCC_CFGR_PPRE2_DIV2;
   \       0x60   0x6813             LDR      R3,[R2, #+0]
   \       0x62   0xF453 0x4300      ORRS     R3,R3,#0x8000
   \       0x66   0x6013             STR      R3,[R2, #+0]
    693              
    694              /* PCLK1 = HCLK / 4*/
    695              RCC->CFGR |= RCC_CFGR_PPRE1_DIV4;
   \       0x68   0x6813             LDR      R3,[R2, #+0]
   \       0x6A   0xF453 0x53A0      ORRS     R3,R3,#0x1400
   \       0x6E   0x6013             STR      R3,[R2, #+0]
    696          #endif /* STM32F40_41xxx || STM32F427_437x || STM32F429_439xx  || STM32F412xG || STM32F446xx || STM32F469_479xx */
    697          
    698          #if defined(STM32F401xx) || defined(STM32F413_423xx)
    699              /* PCLK2 = HCLK / 1*/
    700              RCC->CFGR |= RCC_CFGR_PPRE2_DIV1;
    701              
    702              /* PCLK1 = HCLK / 2*/
    703              RCC->CFGR |= RCC_CFGR_PPRE1_DIV2;
    704          #endif /* STM32F401xx || STM32F413_423xx */
    705          
    706          #if defined(STM32F40_41xxx) || defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F401xx) || defined(STM32F469_479xx)    
    707              /* Configure the main PLL */
    708              RCC->PLLCFGR = PLL_M | (PLL_N << 6) | (((PLL_P >> 1) -1) << 16) |
    709                             (RCC_PLLCFGR_PLLSRC_HSE) | (PLL_Q << 24);
   \       0x70   0x....             LDR.N    R3,??DataTable2_14  ;; 0x7405a08
   \       0x72   0x....             LDR.N    R4,??DataTable2_5  ;; 0x40023804
   \       0x74   0x6023             STR      R3,[R4, #+0]
    710          #endif /* STM32F40_41xxx || STM32F401xx || STM32F427_437x || STM32F429_439xx || STM32F469_479xx */
    711          
    712          #if  defined(STM32F412xG) || defined(STM32F413_423xx) || defined(STM32F446xx)
    713              /* Configure the main PLL */
    714              RCC->PLLCFGR = PLL_M | (PLL_N << 6) | (((PLL_P >> 1) -1) << 16) |
    715                             (RCC_PLLCFGR_PLLSRC_HSE) | (PLL_Q << 24) | (PLL_R << 28);
    716          #endif /* STM32F412xG || STM32F413_423xx || STM32F446xx */    
    717              
    718              /* Enable the main PLL */
    719              RCC->CR |= RCC_CR_PLLON;
   \       0x76   0x680B             LDR      R3,[R1, #+0]
   \       0x78   0xF053 0x7380      ORRS     R3,R3,#0x1000000
   \       0x7C   0x600B             STR      R3,[R1, #+0]
    720          
    721              /* Wait till the main PLL is ready */
    722              while((RCC->CR & RCC_CR_PLLRDY) == 0)
   \                     ??SetSysClock_5: (+1)
   \       0x7E   0x680B             LDR      R3,[R1, #+0]
   \       0x80   0x019B             LSLS     R3,R3,#+6
   \       0x82   0xD5FC             BPL.N    ??SetSysClock_5
    723              {
    724              }
    725             
    726          #if defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F446xx) || defined(STM32F469_479xx)
    727              /* Enable the Over-drive to extend the clock frequency to 180 Mhz */
    728              PWR->CR |= PWR_CR_ODEN;
   \       0x84   0x6801             LDR      R1,[R0, #+0]
   \       0x86   0xF451 0x3180      ORRS     R1,R1,#0x10000
   \       0x8A   0x6001             STR      R1,[R0, #+0]
    729              while((PWR->CSR & PWR_CSR_ODRDY) == 0)
   \                     ??SetSysClock_6: (+1)
   \       0x8C   0x....             LDR.N    R1,??DataTable2_15  ;; 0x40007004
   \       0x8E   0x680B             LDR      R3,[R1, #+0]
   \       0x90   0x03DB             LSLS     R3,R3,#+15
   \       0x92   0xD5FB             BPL.N    ??SetSysClock_6
    730              {
    731              }
    732              PWR->CR |= PWR_CR_ODSWEN;
   \       0x94   0x6803             LDR      R3,[R0, #+0]
   \       0x96   0xF453 0x3300      ORRS     R3,R3,#0x20000
   \       0x9A   0x6003             STR      R3,[R0, #+0]
    733              while((PWR->CSR & PWR_CSR_ODSWRDY) == 0)
   \                     ??SetSysClock_7: (+1)
   \       0x9C   0x6808             LDR      R0,[R1, #+0]
   \       0x9E   0x0380             LSLS     R0,R0,#+14
   \       0xA0   0xD5FC             BPL.N    ??SetSysClock_7
    734              {
    735              }      
    736              /* Configure Flash prefetch, Instruction cache, Data cache and wait state */
    737              FLASH->ACR = FLASH_ACR_PRFTEN | FLASH_ACR_ICEN |FLASH_ACR_DCEN |FLASH_ACR_LATENCY_5WS;
   \       0xA2   0xF240 0x7005      MOVW     R0,#+1797
   \       0xA6   0x....             LDR.N    R1,??DataTable2_16  ;; 0x40023c00
   \       0xA8   0x6008             STR      R0,[R1, #+0]
    738          #endif /* STM32F427_437x || STM32F429_439xx || STM32F446xx || STM32F469_479xx */
    739          
    740          #if defined(STM32F40_41xxx)  || defined(STM32F412xG)  
    741              /* Configure Flash prefetch, Instruction cache, Data cache and wait state */
    742              FLASH->ACR = FLASH_ACR_PRFTEN | FLASH_ACR_ICEN |FLASH_ACR_DCEN |FLASH_ACR_LATENCY_5WS;
    743          #endif /* STM32F40_41xxx  || STM32F412xG */
    744          
    745          #if defined(STM32F413_423xx)  
    746              /* Configure Flash prefetch, Instruction cache, Data cache and wait state */
    747              FLASH->ACR = FLASH_ACR_PRFTEN | FLASH_ACR_ICEN |FLASH_ACR_DCEN |FLASH_ACR_LATENCY_3WS;
    748          #endif /* STM32F413_423xx */
    749          
    750          #if defined(STM32F401xx)
    751              /* Configure Flash prefetch, Instruction cache, Data cache and wait state */
    752              FLASH->ACR = FLASH_ACR_PRFTEN | FLASH_ACR_ICEN |FLASH_ACR_DCEN |FLASH_ACR_LATENCY_2WS;
    753          #endif /* STM32F401xx */
    754          
    755              /* Select the main PLL as system clock source */
    756              RCC->CFGR &= (uint32_t)((uint32_t)~(RCC_CFGR_SW));
   \       0xAA   0x6810             LDR      R0,[R2, #+0]
   \       0xAC   0x0880             LSRS     R0,R0,#+2
   \       0xAE   0x0080             LSLS     R0,R0,#+2
   \       0xB0   0x6010             STR      R0,[R2, #+0]
    757              RCC->CFGR |= RCC_CFGR_SW_PLL;
   \       0xB2   0x6810             LDR      R0,[R2, #+0]
   \       0xB4   0xF050 0x0002      ORRS     R0,R0,#0x2
   \       0xB8   0x6010             STR      R0,[R2, #+0]
    758          
    759              /* Wait till the main PLL is used as system clock source */
    760              while ((RCC->CFGR & (uint32_t)RCC_CFGR_SWS ) != RCC_CFGR_SWS_PLL);
   \                     ??SetSysClock_8: (+1)
   \       0xBA   0x6810             LDR      R0,[R2, #+0]
   \       0xBC   0xF010 0x000C      ANDS     R0,R0,#0xC
   \       0xC0   0x2808             CMP      R0,#+8
   \       0xC2   0xD1FA             BNE.N    ??SetSysClock_8
    761              {
    762              }
    763            }
    764            else
    765            { /* If HSE fails to start-up, the application will have wrong clock
    766                   configuration. User can add here some code to deal with this error */
    767            }
    768          #elif defined(STM32F410xx) || defined(STM32F411xE)
    769          #if defined(USE_HSE_BYPASS) 
    770          /******************************************************************************/
    771          /*            PLL (clocked by HSE) used as System clock source                */
    772          /******************************************************************************/
    773            __IO uint32_t StartUpCounter = 0, HSEStatus = 0;
    774            
    775            /* Enable HSE and HSE BYPASS */
    776            RCC->CR |= ((uint32_t)RCC_CR_HSEON | RCC_CR_HSEBYP);
    777           
    778            /* Wait till HSE is ready and if Time out is reached exit */
    779            do
    780            {
    781              HSEStatus = RCC->CR & RCC_CR_HSERDY;
    782              StartUpCounter++;
    783            } while((HSEStatus == 0) && (StartUpCounter != HSE_STARTUP_TIMEOUT));
    784          
    785            if ((RCC->CR & RCC_CR_HSERDY) != RESET)
    786            {
    787              HSEStatus = (uint32_t)0x01;
    788            }
    789            else
    790            {
    791              HSEStatus = (uint32_t)0x00;
    792            }
    793          
    794            if (HSEStatus == (uint32_t)0x01)
    795            {
    796              /* Select regulator voltage output Scale 1 mode */
    797              RCC->APB1ENR |= RCC_APB1ENR_PWREN;
    798              PWR->CR |= PWR_CR_VOS;
    799          
    800              /* HCLK = SYSCLK / 1*/
    801              RCC->CFGR |= RCC_CFGR_HPRE_DIV1;
    802          
    803              /* PCLK2 = HCLK / 2*/
    804              RCC->CFGR |= RCC_CFGR_PPRE2_DIV1;
    805              
    806              /* PCLK1 = HCLK / 4*/
    807              RCC->CFGR |= RCC_CFGR_PPRE1_DIV2;
    808          
    809              /* Configure the main PLL */
    810              RCC->PLLCFGR = PLL_M | (PLL_N << 6) | (((PLL_P >> 1) -1) << 16) |
    811                             (RCC_PLLCFGR_PLLSRC_HSE) | (PLL_Q << 24);
    812              
    813              /* Enable the main PLL */
    814              RCC->CR |= RCC_CR_PLLON;
    815          
    816              /* Wait till the main PLL is ready */
    817              while((RCC->CR & RCC_CR_PLLRDY) == 0)
    818              {
    819              }
    820          
    821              /* Configure Flash prefetch, Instruction cache, Data cache and wait state */
    822              FLASH->ACR = FLASH_ACR_PRFTEN | FLASH_ACR_ICEN |FLASH_ACR_DCEN |FLASH_ACR_LATENCY_2WS;
    823          
    824              /* Select the main PLL as system clock source */
    825              RCC->CFGR &= (uint32_t)((uint32_t)~(RCC_CFGR_SW));
    826              RCC->CFGR |= RCC_CFGR_SW_PLL;
    827          
    828              /* Wait till the main PLL is used as system clock source */
    829              while ((RCC->CFGR & (uint32_t)RCC_CFGR_SWS ) != RCC_CFGR_SWS_PLL);
    830              {
    831              }
    832            }
    833            else
    834            { /* If HSE fails to start-up, the application will have wrong clock
    835                   configuration. User can add here some code to deal with this error */
    836            }
    837          #else /* HSI will be used as PLL clock source */
    838            /* Select regulator voltage output Scale 1 mode */
    839            RCC->APB1ENR |= RCC_APB1ENR_PWREN;
    840            PWR->CR |= PWR_CR_VOS;
    841            
    842            /* HCLK = SYSCLK / 1*/
    843            RCC->CFGR |= RCC_CFGR_HPRE_DIV1;
    844            
    845            /* PCLK2 = HCLK / 2*/
    846            RCC->CFGR |= RCC_CFGR_PPRE2_DIV1;
    847            
    848            /* PCLK1 = HCLK / 4*/
    849            RCC->CFGR |= RCC_CFGR_PPRE1_DIV2;
    850            
    851            /* Configure the main PLL */
    852            RCC->PLLCFGR = PLL_M | (PLL_N << 6) | (((PLL_P >> 1) -1) << 16) | (PLL_Q << 24); 
    853            
    854            /* Enable the main PLL */
    855            RCC->CR |= RCC_CR_PLLON;
    856            
    857            /* Wait till the main PLL is ready */
    858            while((RCC->CR & RCC_CR_PLLRDY) == 0)
    859            {
    860            }
    861            
    862            /* Configure Flash prefetch, Instruction cache, Data cache and wait state */
    863            FLASH->ACR = FLASH_ACR_PRFTEN | FLASH_ACR_ICEN |FLASH_ACR_DCEN |FLASH_ACR_LATENCY_2WS;
    864            
    865            /* Select the main PLL as system clock source */
    866            RCC->CFGR &= (uint32_t)((uint32_t)~(RCC_CFGR_SW));
    867            RCC->CFGR |= RCC_CFGR_SW_PLL;
    868            
    869            /* Wait till the main PLL is used as system clock source */
    870            while ((RCC->CFGR & (uint32_t)RCC_CFGR_SWS ) != RCC_CFGR_SWS_PLL);
    871            {
    872            }
    873          #endif /* USE_HSE_BYPASS */  
    874          #endif /* STM32F40_41xxx || STM32F427_437xx || STM32F429_439xx || STM32F401xx || STM32F469_479xx */  
    875          }
   \                     ??SetSysClock_4: (+1)
   \       0xC4   0xBC13             POP      {R0,R1,R4}
   \       0xC6   0x4770             BX       LR               ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2:
   \        0x0   0xE000'ED88        DC32     0xe000ed88

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_1:
   \        0x0   0x4002'3800        DC32     0x40023800

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_2:
   \        0x0   0x4002'3808        DC32     0x40023808

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_3:
   \        0x0   0xFEF6'FFFF        DC32     0xfef6ffff

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_4:
   \        0x0   0x2400'3010        DC32     0x24003010

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_5:
   \        0x0   0x4002'3804        DC32     0x40023804

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_6:
   \        0x0   0x4002'380C        DC32     0x4002380c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_7:
   \        0x0   0xE000'ED08        DC32     0xe000ed08

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_8:
   \        0x0   0x00F4'2400        DC32     0xf42400

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_9:
   \        0x0   0x....'....        DC32     SystemCoreClock

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_10:
   \        0x0   0x007A'1200        DC32     0x7a1200

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_11:
   \        0x0   0x....'....        DC32     AHBPrescTable

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_12:
   \        0x0   0x4002'3840        DC32     0x40023840

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_13:
   \        0x0   0x4000'7000        DC32     0x40007000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_14:
   \        0x0   0x0740'5A08        DC32     0x7405a08

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_15:
   \        0x0   0x4000'7004        DC32     0x40007004

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_16:
   \        0x0   0x4002'3C00        DC32     0x40023c00
    876          #if defined (DATA_IN_ExtSRAM) && defined (DATA_IN_ExtSDRAM)
    877          #if defined(STM32F427xx) || defined(STM32F437xx) || defined(STM32F429xx) || defined(STM32F439xx) ||\
    878              defined(STM32F469xx) || defined(STM32F479xx)
    879          /**
    880            * @brief  Setup the external memory controller.
    881            *         Called in startup_stm32f4xx.s before jump to main.
    882            *         This function configures the external memories (SRAM/SDRAM)
    883            *         This SRAM/SDRAM will be used as program data memory (including heap and stack).
    884            * @param  None
    885            * @retval None
    886            */
    887          void SystemInit_ExtMemCtl(void)
    888          {
    889            __IO uint32_t tmp = 0x00;
    890          
    891            register uint32_t tmpreg = 0, timeout = 0xFFFF;
    892            register uint32_t index;
    893          
    894            /* Enable GPIOC, GPIOD, GPIOE, GPIOF, GPIOG, GPIOH and GPIOI interface clock */
    895            RCC->AHB1ENR |= 0x000001F8;
    896          
    897            /* Delay after an RCC peripheral clock enabling */
    898            tmp = READ_BIT(RCC->AHB1ENR, RCC_AHB1ENR_GPIOCEN);
    899            
    900            /* Connect PDx pins to FMC Alternate function */
    901            GPIOD->AFR[0]  = 0x00CCC0CC;
    902            GPIOD->AFR[1]  = 0xCCCCCCCC;
    903            /* Configure PDx pins in Alternate function mode */  
    904            GPIOD->MODER   = 0xAAAA0A8A;
    905            /* Configure PDx pins speed to 100 MHz */  
    906            GPIOD->OSPEEDR = 0xFFFF0FCF;
    907            /* Configure PDx pins Output type to push-pull */  
    908            GPIOD->OTYPER  = 0x00000000;
    909            /* No pull-up, pull-down for PDx pins */ 
    910            GPIOD->PUPDR   = 0x00000000;
    911          
    912            /* Connect PEx pins to FMC Alternate function */
    913            GPIOE->AFR[0]  = 0xC00CC0CC;
    914            GPIOE->AFR[1]  = 0xCCCCCCCC;
    915            /* Configure PEx pins in Alternate function mode */ 
    916            GPIOE->MODER   = 0xAAAA828A;
    917            /* Configure PEx pins speed to 100 MHz */ 
    918            GPIOE->OSPEEDR = 0xFFFFC3CF;
    919            /* Configure PEx pins Output type to push-pull */  
    920            GPIOE->OTYPER  = 0x00000000;
    921            /* No pull-up, pull-down for PEx pins */ 
    922            GPIOE->PUPDR   = 0x00000000;
    923            
    924            /* Connect PFx pins to FMC Alternate function */
    925            GPIOF->AFR[0]  = 0xCCCCCCCC;
    926            GPIOF->AFR[1]  = 0xCCCCCCCC;
    927            /* Configure PFx pins in Alternate function mode */   
    928            GPIOF->MODER   = 0xAA800AAA;
    929            /* Configure PFx pins speed to 50 MHz */ 
    930            GPIOF->OSPEEDR = 0xAA800AAA;
    931            /* Configure PFx pins Output type to push-pull */  
    932            GPIOF->OTYPER  = 0x00000000;
    933            /* No pull-up, pull-down for PFx pins */ 
    934            GPIOF->PUPDR   = 0x00000000;
    935          
    936            /* Connect PGx pins to FMC Alternate function */
    937            GPIOG->AFR[0]  = 0xCCCCCCCC;
    938            GPIOG->AFR[1]  = 0xCCCCCCCC;
    939            /* Configure PGx pins in Alternate function mode */ 
    940            GPIOG->MODER   = 0xAAAAAAAA;
    941            /* Configure PGx pins speed to 50 MHz */ 
    942            GPIOG->OSPEEDR = 0xAAAAAAAA;
    943            /* Configure PGx pins Output type to push-pull */  
    944            GPIOG->OTYPER  = 0x00000000;
    945            /* No pull-up, pull-down for PGx pins */ 
    946            GPIOG->PUPDR   = 0x00000000;
    947            
    948            /* Connect PHx pins to FMC Alternate function */
    949            GPIOH->AFR[0]  = 0x00C0CC00;
    950            GPIOH->AFR[1]  = 0xCCCCCCCC;
    951            /* Configure PHx pins in Alternate function mode */ 
    952            GPIOH->MODER   = 0xAAAA08A0;
    953            /* Configure PHx pins speed to 50 MHz */ 
    954            GPIOH->OSPEEDR = 0xAAAA08A0;
    955            /* Configure PHx pins Output type to push-pull */  
    956            GPIOH->OTYPER  = 0x00000000;
    957            /* No pull-up, pull-down for PHx pins */ 
    958            GPIOH->PUPDR   = 0x00000000;
    959            
    960            /* Connect PIx pins to FMC Alternate function */
    961            GPIOI->AFR[0]  = 0xCCCCCCCC;
    962            GPIOI->AFR[1]  = 0x00000CC0;
    963            /* Configure PIx pins in Alternate function mode */ 
    964            GPIOI->MODER   = 0x0028AAAA;
    965            /* Configure PIx pins speed to 50 MHz */ 
    966            GPIOI->OSPEEDR = 0x0028AAAA;
    967            /* Configure PIx pins Output type to push-pull */  
    968            GPIOI->OTYPER  = 0x00000000;
    969            /* No pull-up, pull-down for PIx pins */ 
    970            GPIOI->PUPDR   = 0x00000000;
    971            
    972          /*-- FMC Configuration -------------------------------------------------------*/
    973            /* Enable the FMC interface clock */
    974            RCC->AHB3ENR |= 0x00000001;
    975            /* Delay after an RCC peripheral clock enabling */
    976            tmp = READ_BIT(RCC->AHB3ENR, RCC_AHB3ENR_FMCEN);
    977          
    978            FMC_Bank5_6->SDCR[0] = 0x000019E4;
    979            FMC_Bank5_6->SDTR[0] = 0x01115351;      
    980            
    981            /* SDRAM initialization sequence */
    982            /* Clock enable command */
    983            FMC_Bank5_6->SDCMR = 0x00000011; 
    984            tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
    985            while((tmpreg != 0) && (timeout-- > 0))
    986            {
    987              tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
    988            }
    989          
    990            /* Delay */
    991            for (index = 0; index<1000; index++);
    992            
    993            /* PALL command */
    994            FMC_Bank5_6->SDCMR = 0x00000012;           
    995            timeout = 0xFFFF;
    996            while((tmpreg != 0) && (timeout-- > 0))
    997            {
    998              tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
    999            }
   1000            
   1001            /* Auto refresh command */
   1002            FMC_Bank5_6->SDCMR = 0x00000073;
   1003            timeout = 0xFFFF;
   1004            while((tmpreg != 0) && (timeout-- > 0))
   1005            {
   1006              tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
   1007            }
   1008           
   1009            /* MRD register program */
   1010            FMC_Bank5_6->SDCMR = 0x00046014;
   1011            timeout = 0xFFFF;
   1012            while((tmpreg != 0) && (timeout-- > 0))
   1013            {
   1014              tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
   1015            } 
   1016            
   1017            /* Set refresh count */
   1018            tmpreg = FMC_Bank5_6->SDRTR;
   1019            FMC_Bank5_6->SDRTR = (tmpreg | (0x0000027C<<1));
   1020            
   1021            /* Disable write protection */
   1022            tmpreg = FMC_Bank5_6->SDCR[0]; 
   1023            FMC_Bank5_6->SDCR[0] = (tmpreg & 0xFFFFFDFF);
   1024          
   1025          #if defined(STM32F427xx) || defined(STM32F437xx) || defined(STM32F429xx) || defined(STM32F439xx)
   1026            /* Configure and enable Bank1_SRAM2 */
   1027            FMC_Bank1->BTCR[2]  = 0x00001011;
   1028            FMC_Bank1->BTCR[3]  = 0x00000201;
   1029            FMC_Bank1E->BWTR[2] = 0x0fffffff;
   1030          #endif /* STM32F427xx || STM32F437xx || STM32F429xx || STM32F439xx */ 
   1031          #if defined(STM32F469xx) || defined(STM32F479xx)
   1032            /* Configure and enable Bank1_SRAM2 */
   1033            FMC_Bank1->BTCR[2]  = 0x00001091;
   1034            FMC_Bank1->BTCR[3]  = 0x00110212;
   1035            FMC_Bank1E->BWTR[2] = 0x0fffffff;
   1036          #endif /* STM32F469xx || STM32F479xx */
   1037          
   1038            (void)(tmp); 
   1039          }
   1040          #endif /* STM32F427xx || STM32F437xx || STM32F429xx || STM32F439xx || STM32F469xx || STM32F479xx */
   1041          #elif defined (DATA_IN_ExtSRAM)
   1042          /**
   1043            * @brief  Setup the external memory controller. Called in startup_stm32f4xx.s 
   1044            *          before jump to __main
   1045            * @param  None
   1046            * @retval None
   1047            */ 
   1048          /**
   1049            * @brief  Setup the external memory controller.
   1050            *         Called in startup_stm32f4xx.s before jump to main.
   1051            *         This function configures the external SRAM mounted on STM324xG_EVAL/STM324x7I boards
   1052            *         This SRAM will be used as program data memory (including heap and stack).
   1053            * @param  None
   1054            * @retval None
   1055            */
   1056          void SystemInit_ExtMemCtl(void)
   1057          {
   1058          /*-- GPIOs Configuration -----------------------------------------------------*/
   1059          /*
   1060           +-------------------+--------------------+------------------+--------------+
   1061           +                       SRAM pins assignment                               +
   1062           +-------------------+--------------------+------------------+--------------+
   1063           | PD0  <-> FMC_D2  | PE0  <-> FMC_NBL0 | PF0  <-> FMC_A0 | PG0 <-> FMC_A10 | 
   1064           | PD1  <-> FMC_D3  | PE1  <-> FMC_NBL1 | PF1  <-> FMC_A1 | PG1 <-> FMC_A11 | 
   1065           | PD4  <-> FMC_NOE | PE3  <-> FMC_A19  | PF2  <-> FMC_A2 | PG2 <-> FMC_A12 | 
   1066           | PD5  <-> FMC_NWE | PE4  <-> FMC_A20  | PF3  <-> FMC_A3 | PG3 <-> FMC_A13 | 
   1067           | PD8  <-> FMC_D13 | PE7  <-> FMC_D4   | PF4  <-> FMC_A4 | PG4 <-> FMC_A14 | 
   1068           | PD9  <-> FMC_D14 | PE8  <-> FMC_D5   | PF5  <-> FMC_A5 | PG5 <-> FMC_A15 | 
   1069           | PD10 <-> FMC_D15 | PE9  <-> FMC_D6   | PF12 <-> FMC_A6 | PG9 <-> FMC_NE2 | 
   1070           | PD11 <-> FMC_A16 | PE10 <-> FMC_D7   | PF13 <-> FMC_A7 |-----------------+
   1071           | PD12 <-> FMC_A17 | PE11 <-> FMC_D8   | PF14 <-> FMC_A8 | 
   1072           | PD13 <-> FMC_A18 | PE12 <-> FMC_D9   | PF15 <-> FMC_A9 | 
   1073           | PD14 <-> FMC_D0  | PE13 <-> FMC_D10  |-----------------+
   1074           | PD15 <-> FMC_D1  | PE14 <-> FMC_D11  |
   1075           |                  | PE15 <-> FMC_D12  |
   1076           +------------------+------------------+
   1077          */
   1078             /* Enable GPIOD, GPIOE, GPIOF and GPIOG interface clock */
   1079            RCC->AHB1ENR   |= 0x00000078;
   1080            
   1081            /* Connect PDx pins to FMC Alternate function */
   1082            GPIOD->AFR[0]  = 0x00cc00cc;
   1083            GPIOD->AFR[1]  = 0xcccccccc;
   1084            /* Configure PDx pins in Alternate function mode */  
   1085            GPIOD->MODER   = 0xaaaa0a0a;
   1086            /* Configure PDx pins speed to 100 MHz */  
   1087            GPIOD->OSPEEDR = 0xffff0f0f;
   1088            /* Configure PDx pins Output type to push-pull */  
   1089            GPIOD->OTYPER  = 0x00000000;
   1090            /* No pull-up, pull-down for PDx pins */ 
   1091            GPIOD->PUPDR   = 0x00000000;
   1092          
   1093            /* Connect PEx pins to FMC Alternate function */
   1094            GPIOE->AFR[0]  = 0xcccccccc;
   1095            GPIOE->AFR[1]  = 0xcccccccc;
   1096            /* Configure PEx pins in Alternate function mode */ 
   1097            GPIOE->MODER   = 0xaaaaaaaa;
   1098            /* Configure PEx pins speed to 100 MHz */ 
   1099            GPIOE->OSPEEDR = 0xffffffff;
   1100            /* Configure PEx pins Output type to push-pull */  
   1101            GPIOE->OTYPER  = 0x00000000;
   1102            /* No pull-up, pull-down for PEx pins */ 
   1103            GPIOE->PUPDR   = 0x00000000;
   1104          
   1105            /* Connect PFx pins to FMC Alternate function */
   1106            GPIOF->AFR[0]  = 0x00cccccc;
   1107            GPIOF->AFR[1]  = 0xcccc0000;
   1108            /* Configure PFx pins in Alternate function mode */   
   1109            GPIOF->MODER   = 0xaa000aaa;
   1110            /* Configure PFx pins speed to 100 MHz */ 
   1111            GPIOF->OSPEEDR = 0xff000fff;
   1112            /* Configure PFx pins Output type to push-pull */  
   1113            GPIOF->OTYPER  = 0x00000000;
   1114            /* No pull-up, pull-down for PFx pins */ 
   1115            GPIOF->PUPDR   = 0x00000000;
   1116          
   1117            /* Connect PGx pins to FMC Alternate function */
   1118            GPIOG->AFR[0]  = 0x00cccccc;
   1119            GPIOG->AFR[1]  = 0x000000c0;
   1120            /* Configure PGx pins in Alternate function mode */ 
   1121            GPIOG->MODER   = 0x00080aaa;
   1122            /* Configure PGx pins speed to 100 MHz */ 
   1123            GPIOG->OSPEEDR = 0x000c0fff;
   1124            /* Configure PGx pins Output type to push-pull */  
   1125            GPIOG->OTYPER  = 0x00000000;
   1126            /* No pull-up, pull-down for PGx pins */ 
   1127            GPIOG->PUPDR   = 0x00000000;
   1128            
   1129          /*-- FMC Configuration ------------------------------------------------------*/
   1130            /* Enable the FMC/FSMC interface clock */
   1131            RCC->AHB3ENR         |= 0x00000001;
   1132            
   1133          #if defined(STM32F427_437xx) || defined(STM32F429_439xx) || defined(STM32F446xx) || defined(STM32F469_479xx)
   1134            /* Configure and enable Bank1_SRAM2 */
   1135            FMC_Bank1->BTCR[2]  = 0x00001011;
   1136            FMC_Bank1->BTCR[3]  = 0x00000201;
   1137            FMC_Bank1E->BWTR[2] = 0x0fffffff;
   1138          #endif /* STM32F427_437xx || STM32F429_439xx || STM32F446xx || STM32F469_479xx */ 
   1139          
   1140          #if defined(STM32F40_41xxx)
   1141            /* Configure and enable Bank1_SRAM2 */
   1142            FSMC_Bank1->BTCR[2]  = 0x00001011;
   1143            FSMC_Bank1->BTCR[3]  = 0x00000201;
   1144            FSMC_Bank1E->BWTR[2] = 0x0fffffff;
   1145          #endif  /* STM32F40_41xxx */
   1146          
   1147          /*
   1148            Bank1_SRAM2 is configured as follow:
   1149            In case of FSMC configuration 
   1150            NORSRAMTimingStructure.FSMC_AddressSetupTime = 1;
   1151            NORSRAMTimingStructure.FSMC_AddressHoldTime = 0;
   1152            NORSRAMTimingStructure.FSMC_DataSetupTime = 2;
   1153            NORSRAMTimingStructure.FSMC_BusTurnAroundDuration = 0;
   1154            NORSRAMTimingStructure.FSMC_CLKDivision = 0;
   1155            NORSRAMTimingStructure.FSMC_DataLatency = 0;
   1156            NORSRAMTimingStructure.FSMC_AccessMode = FMC_AccessMode_A;
   1157          
   1158            FSMC_NORSRAMInitStructure.FSMC_Bank = FSMC_Bank1_NORSRAM2;
   1159            FSMC_NORSRAMInitStructure.FSMC_DataAddressMux = FSMC_DataAddressMux_Disable;
   1160            FSMC_NORSRAMInitStructure.FSMC_MemoryType = FSMC_MemoryType_SRAM;
   1161            FSMC_NORSRAMInitStructure.FSMC_MemoryDataWidth = FSMC_MemoryDataWidth_16b;
   1162            FSMC_NORSRAMInitStructure.FSMC_BurstAccessMode = FSMC_BurstAccessMode_Disable;
   1163            FSMC_NORSRAMInitStructure.FSMC_AsynchronousWait = FSMC_AsynchronousWait_Disable;  
   1164            FSMC_NORSRAMInitStructure.FSMC_WaitSignalPolarity = FSMC_WaitSignalPolarity_Low;
   1165            FSMC_NORSRAMInitStructure.FSMC_WrapMode = FSMC_WrapMode_Disable;
   1166            FSMC_NORSRAMInitStructure.FSMC_WaitSignalActive = FSMC_WaitSignalActive_BeforeWaitState;
   1167            FSMC_NORSRAMInitStructure.FSMC_WriteOperation = FSMC_WriteOperation_Enable;
   1168            FSMC_NORSRAMInitStructure.FSMC_WaitSignal = FSMC_WaitSignal_Disable;
   1169            FSMC_NORSRAMInitStructure.FSMC_ExtendedMode = FSMC_ExtendedMode_Disable;
   1170            FSMC_NORSRAMInitStructure.FSMC_WriteBurst = FSMC_WriteBurst_Disable;
   1171            FSMC_NORSRAMInitStructure.FSMC_ReadWriteTimingStruct = &NORSRAMTimingStructure;
   1172            FSMC_NORSRAMInitStructure.FSMC_WriteTimingStruct = &NORSRAMTimingStructure;
   1173          
   1174            In case of FMC configuration   
   1175            NORSRAMTimingStructure.FMC_AddressSetupTime = 1;
   1176            NORSRAMTimingStructure.FMC_AddressHoldTime = 0;
   1177            NORSRAMTimingStructure.FMC_DataSetupTime = 2;
   1178            NORSRAMTimingStructure.FMC_BusTurnAroundDuration = 0;
   1179            NORSRAMTimingStructure.FMC_CLKDivision = 0;
   1180            NORSRAMTimingStructure.FMC_DataLatency = 0;
   1181            NORSRAMTimingStructure.FMC_AccessMode = FMC_AccessMode_A;
   1182          
   1183            FMC_NORSRAMInitStructure.FMC_Bank = FMC_Bank1_NORSRAM2;
   1184            FMC_NORSRAMInitStructure.FMC_DataAddressMux = FMC_DataAddressMux_Disable;
   1185            FMC_NORSRAMInitStructure.FMC_MemoryType = FMC_MemoryType_SRAM;
   1186            FMC_NORSRAMInitStructure.FMC_MemoryDataWidth = FMC_MemoryDataWidth_16b;
   1187            FMC_NORSRAMInitStructure.FMC_BurstAccessMode = FMC_BurstAccessMode_Disable;
   1188            FMC_NORSRAMInitStructure.FMC_AsynchronousWait = FMC_AsynchronousWait_Disable;  
   1189            FMC_NORSRAMInitStructure.FMC_WaitSignalPolarity = FMC_WaitSignalPolarity_Low;
   1190            FMC_NORSRAMInitStructure.FMC_WrapMode = FMC_WrapMode_Disable;
   1191            FMC_NORSRAMInitStructure.FMC_WaitSignalActive = FMC_WaitSignalActive_BeforeWaitState;
   1192            FMC_NORSRAMInitStructure.FMC_WriteOperation = FMC_WriteOperation_Enable;
   1193            FMC_NORSRAMInitStructure.FMC_WaitSignal = FMC_WaitSignal_Disable;
   1194            FMC_NORSRAMInitStructure.FMC_ExtendedMode = FMC_ExtendedMode_Disable;
   1195            FMC_NORSRAMInitStructure.FMC_WriteBurst = FMC_WriteBurst_Disable;
   1196            FMC_NORSRAMInitStructure.FMC_ContinousClock = FMC_CClock_SyncOnly;
   1197            FMC_NORSRAMInitStructure.FMC_ReadWriteTimingStruct = &NORSRAMTimingStructure;
   1198            FMC_NORSRAMInitStructure.FMC_WriteTimingStruct = &NORSRAMTimingStructure;
   1199          */
   1200            
   1201          }  
   1202          #elif defined (DATA_IN_ExtSDRAM)
   1203          /**
   1204            * @brief  Setup the external memory controller.
   1205            *         Called in startup_stm32f4xx.s before jump to main.
   1206            *         This function configures the external SDRAM mounted on STM324x9I_EVAL board
   1207            *         This SDRAM will be used as program data memory (including heap and stack).
   1208            * @param  None
   1209            * @retval None
   1210            */
   1211          void SystemInit_ExtMemCtl(void)
   1212          {
   1213            register uint32_t tmpreg = 0, timeout = 0xFFFF;
   1214            register uint32_t index;
   1215          
   1216            /* Enable GPIOC, GPIOD, GPIOE, GPIOF, GPIOG, GPIOH and GPIOI interface 
   1217                clock */
   1218            RCC->AHB1ENR |= 0x000001FC;
   1219            
   1220            /* Connect PCx pins to FMC Alternate function */
   1221            GPIOC->AFR[0]  = 0x0000000c;
   1222            GPIOC->AFR[1]  = 0x00007700;
   1223            /* Configure PCx pins in Alternate function mode */  
   1224            GPIOC->MODER   = 0x00a00002;
   1225            /* Configure PCx pins speed to 50 MHz */  
   1226            GPIOC->OSPEEDR = 0x00a00002;
   1227            /* Configure PCx pins Output type to push-pull */  
   1228            GPIOC->OTYPER  = 0x00000000;
   1229            /* No pull-up, pull-down for PCx pins */ 
   1230            GPIOC->PUPDR   = 0x00500000;
   1231            
   1232            /* Connect PDx pins to FMC Alternate function */
   1233            GPIOD->AFR[0]  = 0x000000CC;
   1234            GPIOD->AFR[1]  = 0xCC000CCC;
   1235            /* Configure PDx pins in Alternate function mode */  
   1236            GPIOD->MODER   = 0xA02A000A;
   1237            /* Configure PDx pins speed to 50 MHz */  
   1238            GPIOD->OSPEEDR = 0xA02A000A;
   1239            /* Configure PDx pins Output type to push-pull */  
   1240            GPIOD->OTYPER  = 0x00000000;
   1241            /* No pull-up, pull-down for PDx pins */ 
   1242            GPIOD->PUPDR   = 0x00000000;
   1243          
   1244            /* Connect PEx pins to FMC Alternate function */
   1245            GPIOE->AFR[0]  = 0xC00000CC;
   1246            GPIOE->AFR[1]  = 0xCCCCCCCC;
   1247            /* Configure PEx pins in Alternate function mode */ 
   1248            GPIOE->MODER   = 0xAAAA800A;
   1249            /* Configure PEx pins speed to 50 MHz */ 
   1250            GPIOE->OSPEEDR = 0xAAAA800A;
   1251            /* Configure PEx pins Output type to push-pull */  
   1252            GPIOE->OTYPER  = 0x00000000;
   1253            /* No pull-up, pull-down for PEx pins */ 
   1254            GPIOE->PUPDR   = 0x00000000;
   1255          
   1256            /* Connect PFx pins to FMC Alternate function */
   1257            GPIOF->AFR[0]  = 0xcccccccc;
   1258            GPIOF->AFR[1]  = 0xcccccccc;
   1259            /* Configure PFx pins in Alternate function mode */   
   1260            GPIOF->MODER   = 0xAA800AAA;
   1261            /* Configure PFx pins speed to 50 MHz */ 
   1262            GPIOF->OSPEEDR = 0xAA800AAA;
   1263            /* Configure PFx pins Output type to push-pull */  
   1264            GPIOF->OTYPER  = 0x00000000;
   1265            /* No pull-up, pull-down for PFx pins */ 
   1266            GPIOF->PUPDR   = 0x00000000;
   1267          
   1268            /* Connect PGx pins to FMC Alternate function */
   1269            GPIOG->AFR[0]  = 0xcccccccc;
   1270            GPIOG->AFR[1]  = 0xcccccccc;
   1271            /* Configure PGx pins in Alternate function mode */ 
   1272            GPIOG->MODER   = 0xaaaaaaaa;
   1273            /* Configure PGx pins speed to 50 MHz */ 
   1274            GPIOG->OSPEEDR = 0xaaaaaaaa;
   1275            /* Configure PGx pins Output type to push-pull */  
   1276            GPIOG->OTYPER  = 0x00000000;
   1277            /* No pull-up, pull-down for PGx pins */ 
   1278            GPIOG->PUPDR   = 0x00000000;
   1279            
   1280            /* Connect PHx pins to FMC Alternate function */
   1281            GPIOH->AFR[0]  = 0x00C0CC00;
   1282            GPIOH->AFR[1]  = 0xCCCCCCCC;
   1283            /* Configure PHx pins in Alternate function mode */ 
   1284            GPIOH->MODER   = 0xAAAA08A0;
   1285            /* Configure PHx pins speed to 50 MHz */ 
   1286            GPIOH->OSPEEDR = 0xAAAA08A0;
   1287            /* Configure PHx pins Output type to push-pull */  
   1288            GPIOH->OTYPER  = 0x00000000;
   1289            /* No pull-up, pull-down for PHx pins */ 
   1290            GPIOH->PUPDR   = 0x00000000;
   1291            
   1292            /* Connect PIx pins to FMC Alternate function */
   1293            GPIOI->AFR[0]  = 0xCCCCCCCC;
   1294            GPIOI->AFR[1]  = 0x00000CC0;
   1295            /* Configure PIx pins in Alternate function mode */ 
   1296            GPIOI->MODER   = 0x0028AAAA;
   1297            /* Configure PIx pins speed to 50 MHz */ 
   1298            GPIOI->OSPEEDR = 0x0028AAAA;
   1299            /* Configure PIx pins Output type to push-pull */  
   1300            GPIOI->OTYPER  = 0x00000000;
   1301            /* No pull-up, pull-down for PIx pins */ 
   1302            GPIOI->PUPDR   = 0x00000000;
   1303            
   1304          /*-- FMC Configuration ------------------------------------------------------*/
   1305            /* Enable the FMC interface clock */
   1306            RCC->AHB3ENR |= 0x00000001;
   1307            
   1308            /* Configure and enable SDRAM bank1 */
   1309            FMC_Bank5_6->SDCR[0] = 0x000039D0;
   1310            FMC_Bank5_6->SDTR[0] = 0x01115351;      
   1311            
   1312            /* SDRAM initialization sequence */
   1313            /* Clock enable command */
   1314            FMC_Bank5_6->SDCMR = 0x00000011; 
   1315            tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
   1316            while((tmpreg != 0) & (timeout-- > 0))
   1317            {
   1318              tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
   1319            }
   1320            
   1321            /* Delay */
   1322            for (index = 0; index<1000; index++);
   1323            
   1324            /* PALL command */
   1325            FMC_Bank5_6->SDCMR = 0x00000012;           
   1326            timeout = 0xFFFF;
   1327            while((tmpreg != 0) & (timeout-- > 0))
   1328            {
   1329            tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
   1330            }
   1331            
   1332            /* Auto refresh command */
   1333            FMC_Bank5_6->SDCMR = 0x00000073;
   1334            timeout = 0xFFFF;
   1335            while((tmpreg != 0) & (timeout-- > 0))
   1336            {
   1337            tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
   1338            }
   1339           
   1340            /* MRD register program */
   1341            FMC_Bank5_6->SDCMR = 0x00046014;
   1342            timeout = 0xFFFF;
   1343            while((tmpreg != 0) & (timeout-- > 0))
   1344            {
   1345            tmpreg = FMC_Bank5_6->SDSR & 0x00000020; 
   1346            } 
   1347            
   1348            /* Set refresh count */
   1349            tmpreg = FMC_Bank5_6->SDRTR;
   1350            FMC_Bank5_6->SDRTR = (tmpreg | (0x0000027C<<1));
   1351            
   1352            /* Disable write protection */
   1353            tmpreg = FMC_Bank5_6->SDCR[0]; 
   1354            FMC_Bank5_6->SDCR[0] = (tmpreg & 0xFFFFFDFF);
   1355            
   1356          /*
   1357            Bank1_SDRAM is configured as follow:
   1358          
   1359            FMC_SDRAMTimingInitStructure.FMC_LoadToActiveDelay = 2;      
   1360            FMC_SDRAMTimingInitStructure.FMC_ExitSelfRefreshDelay = 6;  
   1361            FMC_SDRAMTimingInitStructure.FMC_SelfRefreshTime = 4;        
   1362            FMC_SDRAMTimingInitStructure.FMC_RowCycleDelay = 6;         
   1363            FMC_SDRAMTimingInitStructure.FMC_WriteRecoveryTime = 2;      
   1364            FMC_SDRAMTimingInitStructure.FMC_RPDelay = 2;                
   1365            FMC_SDRAMTimingInitStructure.FMC_RCDDelay = 2;               
   1366          
   1367            FMC_SDRAMInitStructure.FMC_Bank = SDRAM_BANK;
   1368            FMC_SDRAMInitStructure.FMC_ColumnBitsNumber = FMC_ColumnBits_Number_8b;
   1369            FMC_SDRAMInitStructure.FMC_RowBitsNumber = FMC_RowBits_Number_11b;
   1370            FMC_SDRAMInitStructure.FMC_SDMemoryDataWidth = FMC_SDMemory_Width_16b;
   1371            FMC_SDRAMInitStructure.FMC_InternalBankNumber = FMC_InternalBank_Number_4;
   1372            FMC_SDRAMInitStructure.FMC_CASLatency = FMC_CAS_Latency_3; 
   1373            FMC_SDRAMInitStructure.FMC_WriteProtection = FMC_Write_Protection_Disable;
   1374            FMC_SDRAMInitStructure.FMC_SDClockPeriod = FMC_SDClock_Period_2;
   1375            FMC_SDRAMInitStructure.FMC_ReadBurst = FMC_Read_Burst_disable;
   1376            FMC_SDRAMInitStructure.FMC_ReadPipeDelay = FMC_ReadPipe_Delay_1;
   1377            FMC_SDRAMInitStructure.FMC_SDRAMTimingStruct = &FMC_SDRAMTimingInitStructure;
   1378          */
   1379            
   1380          }
   1381          #endif /* DATA_IN_ExtSDRAM && DATA_IN_ExtSRAM */
   1382          
   1383          
   1384          /**
   1385            * @}
   1386            */
   1387          
   1388          /**
   1389            * @}
   1390            */
   1391            
   1392          /**
   1393            * @}
   1394            */    
   1395          /************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      12   SetSysClock
       0   SystemCoreClockUpdate
       8   SystemInit
         8   -> SetSysClock


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable2
       4  ??DataTable2_1
       4  ??DataTable2_10
       4  ??DataTable2_11
       4  ??DataTable2_12
       4  ??DataTable2_13
       4  ??DataTable2_14
       4  ??DataTable2_15
       4  ??DataTable2_16
       4  ??DataTable2_2
       4  ??DataTable2_3
       4  ??DataTable2_4
       4  ??DataTable2_5
       4  ??DataTable2_6
       4  ??DataTable2_7
       4  ??DataTable2_8
       4  ??DataTable2_9
      16  AHBPrescTable
     200  SetSysClock
       4  SystemCoreClock
     142  SystemCoreClockUpdate
      70  SystemInit

 
  20 bytes in section .data
 480 bytes in section .text
 
 480 bytes of CODE memory
  20 bytes of DATA memory

Errors: none
Warnings: none
